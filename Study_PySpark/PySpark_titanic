#pip install pyspark
import pandas as pd
import numpy as np
import os
#import matplotlib.pyplot as plt
#import seaborn as sns
#plt.rc('font', family='AppleGothic')
#plt.rcParams['axes.unicode_minus'] = False

# Pyspark - SQL
from pyspark.sql import SparkSession
from pyspark.sql import SQLContext
from pyspark.sql.functions import mean, col, split, regexp_extract, when, lit
from pyspark.sql import Row
from pyspark.sql import SparkSession
from pyspark import SparkContext

# Pyspark - ML
from pyspark.ml import Pipeline
from pyspark.ml.feature import StringIndexer, VectorAssembler
from pyspark.ml.evaluation import MulticlassClassificationEvaluator
from pyspark.ml.feature import QuantileDiscretizer

sc = SparkContext.getOrCreate() 

# SparkSession 생성
spark = SparkSession.builder\
        .appName('Play with pypsark ML on Titanic Data')\
        .getOrCreate()
# 데이터 로드
df = spark.read.csv('titanic/train.csv', header=True, inferSchema=True)
# toPandas()를 이용해 판다스에서 제공하는 데이터프레임 형태로 출력
df.limit(3).toPandas()
